
drop table order_detail, product;
drop table vendor,  cus_order, customer;


CREATE TABLE VENDOR (
 V_CODE     NUMERIC(5)   NOT NULL,
 V_NAME     VARCHAR(35) NOT NULL,
 V_CONTACT  VARCHAR(15) NOT NULL,
 V_AREACODE VARCHAR(3)     NOT NULL,
 V_PHONE    VARCHAR(8)     NOT NULL,
 V_STATE    VARCHAR(3)     NOT NULL,
 V_ORDER    VARCHAR(1)     NOT NULL,
 CONSTRAINT VENDOR_PK PRIMARY KEY (V_CODE));

CREATE TABLE PRODUCT (
 P_CODE     varchar(10)
   CONSTRAINT PRODUCT_P_CODE_PK PRIMARY KEY,
 P_DESCRIPT varchar(35) NOT NULL,
 P_INDATETIME   DATETIME         NOT NULL,

 -- total number of products current in stock
 P_ONHAND   NUMERIC(4)    NOT NULL,

 -- recommended minimum number of products to be sold in each order
 P_MIN      NUMERIC(4)    NOT NULL,

 P_PRICE    NUMERIC(8,2)  NOT NULL,
 P_DISCOUNT NUMERIC(4,2)  NOT NULL CHECK (P_DISCOUNT >= 0 AND P_DISCOUNT < 1),
 V_CODE     NUMERIC(5),
   CONSTRAINT PRODUCT_V_CODE_FK
   FOREIGN KEY (V_CODE) REFERENCES VENDOR);


CREATE TABLE CUSTOMER (
CUS_CODE       	NUMERIC(6)
 CONSTRAINT CUSTOMER_PK PRIMARY KEY,
CUS_LNAME       varchar(15) NOT NULL,
CUS_FNAME       varchar(15) NOT NULL,
CUS_INITIAL     CHAR(1),
CUS_AREACODE 	VARCHAR(3) DEFAULT '02' NOT NULL CHECK(CUS_AREACODE IN ('03','07','08')),
CUS_PHONE       VARCHAR(8) NOT NULL,
CUS_BALANCE     NUMERIC(9,2) DEFAULT 0.00);

CREATE TABLE CUS_ORDER (
ORDER_CODE       NUMERIC(6)
 CONSTRAINT ORDER_PK PRIMARY KEY,
CUS_CODE       NUMERIC(6) NOT NULL

CONSTRAINT CUS_ORDER_FK FOREIGN KEY(CUS_CODE) REFERENCES CUSTOMER

,
ORDDATETIME       DATETIME);

CREATE TABLE ORDER_DETAIL(
ORDER_CODE	NUMERIC(6),
PRODUCT_CODE	VARCHAR(10),
QUANTITY	NUMERIC(4) DEFAULT 1 CHECK (QUANTITY >=0),
  CONSTRAINT ORD_DETAIL_PK PRIMARY KEY(ORDER_CODE,PRODUCT_CODE),
  CONSTRAINT ORD_DETAIL_FK1 FOREIGN KEY (ORDER_CODE) REFERENCES CUS_ORDER(ORDER_CODE),
  CONSTRAINT ORD_DETAIL_FK2 FOREIGN KEY (PRODUCT_CODE) REFERENCES PRODUCT(P_CODE));

--------------------------------------------------------------------------------------
-- order_detail, product;
-- vendor,  cus_order, customer;

SELECT * FROM ORDER_DETAIL;
SELECT * FROM PRODUCT;
SELECT * FROM VENDOR;
SELECT * FROM CUS_ORDER;
SELECT * FROM CUSTOMER;
-- check the diagram in pract9_question7:
